<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.7.1">
<meta name="author" content="Dr. Yves J. Hilpisch | &lt;training@tpq.io&gt;">
<title>Python for Finance</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Uncomment @import statement below to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote::before{display:none}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{word-spacing:0;line-height:1.6}
.quoteblock.abstract blockquote::before,.quoteblock.abstract p::before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd){background:#f8f8f7}
table.stripes-none tr,table.stripes-odd tr:nth-of-type(even){background:none}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Python for Finance</h1>
<div class="details">
<span id="author" class="author">Dr. Yves J. Hilpisch | &lt;training@tpq.io&gt;</span><br>
<span id="revdate">The Python Quants GmbH | www.tpq.io</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#why_python_for_finance">1. Why Python for Finance</a>
<ul class="sectlevel2">
<li><a href="#_finance_and_python_syntax">1.1. Finance and Python Syntax</a></li>
<li><a href="#_efficiency_and_productivity_through_python">1.2. Efficiency and Productivity Through Python</a></li>
<li><a href="#_conclusions">1.3. Conclusions</a></li>
<li><a href="#_further_resources">1.4. Further Resources</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="why_python_for_finance">1. Why Python for Finance</h2>
<div class="sectionbody">
<div class="quoteblock align_me_right">
<blockquote>
<div class="paragraph">
<p>Banks are essentially technology firms.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Hugo Banziger
</div>
</div>
<div class="sect2">
<h3 id="_finance_and_python_syntax">1.1. Finance and Python Syntax</h3>
<div class="paragraph">
<p>Most people who make their first steps with Python in a finance context may attack an algorithmic problem. This is similar to a scientist who, for example, wants to solve a differential equation, wants to evaluate an integral or simply wants to visualize some data. In general, at this stage, there is only little thought spent on topics like a formal development process, testing, documentation or deployment. However, this especially seems to be the stage when people fall in love with Python. A major reason for this might be that Python syntax is generally quite close to the mathematical syntax used to describe scientific problems or financial algorithms.</p>
</div>
<div class="paragraph">
<p>This aspect can be illustrated by a financial algorithm, namely the valuation of a European call option by Monte Carlo simulation. The example considers a Black-Scholes-Merton (BSM) setup in which the option&#8217;s underlying risk factor follows a geometric Brownian motion.</p>
</div>
<div class="paragraph">
<p>Assume the following numerical <em>parameter values</em> for the valuation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>initial stock index level \(S_0 = 100\)</p>
</li>
<li>
<p>strike price of the European call option \(K = 105\)</p>
</li>
<li>
<p>time-to-maturity \(T = 1\) year</p>
</li>
<li>
<p>constant, riskless short rate \(r = 0.05\)</p>
</li>
<li>
<p>constant volatility \(\sigma = 0.2\)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In the BSM model, the index level at maturity is a random variable, given by <a href="#bsm_rv">Black-Scholes-Merton (1973) index level at maturity</a> with \(z\) being a standard normally distributed random variable.</p>
</div>
<div id="bsm_rv" class="stemblock">
<div class="title">Black-Scholes-Merton (1973) index level at maturity</div>
<div class="content">
\[\begin{equation}
S_T = S_0 \exp \left( \left( r - \frac{1}{2} \sigma^2 \right) T + \sigma \sqrt{T} z \right)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>The following is an <em>algorithmic description</em> of the Monte Carlo valuation procedure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>draw \(I\) pseudo-random numbers \(z(i), i \in \{1, 2, ..., I \}\), from the standard normal distribution</p>
</li>
<li>
<p>calculate all resulting index levels at maturity \(S_T(i)\) for given \(z(i)\) and <a href="#bsm_rv">Black-Scholes-Merton (1973) index level at maturity</a></p>
</li>
<li>
<p>calculate all inner values of the option at maturity as \(h_T(i)= \max \left(S_T(i) - K, 0 \right)\)</p>
</li>
<li>
<p>estimate the option present value via the Monte Carlo estimator as given in <a href="#bsm_mcs_est">Monte Carlo estimator for European option</a></p>
</li>
</ol>
</div>
<div id="bsm_mcs_est" class="stemblock">
<div class="title">Monte Carlo estimator for European option</div>
<div class="content">
\[\begin{equation}
C_0 \approx e^{-rT} \frac{1}{I} \sum_I h_T(i)
\end{equation}\]
</div>
</div>
<div class="paragraph">
<p>This problem and algorithm is now to be translated into Python code. The code below implements the required steps.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">In [<span class="integer">1</span>]: <span class="keyword">import</span> <span class="include">math</span>
        <span class="keyword">import</span> <span class="include">numpy</span> <span class="keyword">as</span> np  <i class="conum" data-value="1"></i><b>(1)</b>

In [<span class="integer">2</span>]: S0 = <span class="float">100.</span>  <i class="conum" data-value="2"></i><b>(2)</b>
        K = <span class="float">105.</span>  <i class="conum" data-value="2"></i><b>(2)</b>
        T = <span class="float">1.0</span>  <i class="conum" data-value="2"></i><b>(2)</b>
        r = <span class="float">0.05</span>  <i class="conum" data-value="2"></i><b>(2)</b>
        sigma = <span class="float">0.2</span>  <i class="conum" data-value="2"></i><b>(2)</b>

In [<span class="integer">3</span>]: I = <span class="integer">100000</span>  <i class="conum" data-value="2"></i><b>(2)</b>

In [<span class="integer">4</span>]: np.random.seed(<span class="integer">1000</span>)  <i class="conum" data-value="3"></i><b>(3)</b>

In [<span class="integer">5</span>]: z = np.random.standard_normal(I)  <i class="conum" data-value="4"></i><b>(4)</b>

In [<span class="integer">6</span>]: ST = S0 * np.exp((r - sigma ** <span class="integer">2</span> / <span class="integer">2</span>) * T + sigma * math.sqrt(T) * z)  <i class="conum" data-value="5"></i><b>(5)</b>

In [<span class="integer">7</span>]: hT = np.maximum(ST - K, <span class="integer">0</span>)  <i class="conum" data-value="6"></i><b>(6)</b>

In [<span class="integer">8</span>]: C0 = math.exp(-r * T) * np.mean(hT)  <i class="conum" data-value="7"></i><b>(7)</b>

In [<span class="integer">9</span>]: print(<span class="string"><span class="delimiter">'</span><span class="content">Value of the European call option: {:5.3f}.</span><span class="delimiter">'</span></span>.format(C0))  <i class="conum" data-value="8"></i><b>(8)</b>
        Value of the European call option: <span class="float">8.019</span>.</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The model and simulation parameter values are defined.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>NumPy</code> is used here as the main package.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The seed value for the random number generator is fixed.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Standard normally distributed random numbers are drawn.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>End-of-period values are simulated.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The option payoffs at maturity are calculated.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The Monte Carlo estimator is evaluated.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>The resulting value estimate is printed.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Three aspects are worth highlighting:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">syntax</dt>
<dd>
<p>the Python syntax is indeed quite close to the mathematical syntax, e.g., when it comes to the parameter value assignments</p>
</dd>
<dt class="hdlist1">translation</dt>
<dd>
<p>every mathematical and/or algorithmic statement can generally be translated into a <em>single</em> line of Python code</p>
</dd>
<dt class="hdlist1">vectorization</dt>
<dd>
<p>one of the strengths of <code>NumPy</code> is the compact, vectorized syntax, e.g., allowing for 100,000 calculations within a single line of code</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This code can be used in an interactive environment like <code>IPython</code> or <code>Jupyter Notebook</code>. However, code that is meant to be reused regularly typically gets organized in so-called <em>modules</em> (or <em>scripts</em>), which are single Python files (technically text files) with the suffix <code>.py</code>. Such a module could in this case look like <a href="#bsm_mcs_euro">Monte Carlo valuation of European call option</a> and could be saved as a file named <code>bsm_mcs_euro.py</code>.</p>
</div>
<div id="bsm_mcs_euro" class="exampleblock">
<div class="title">Example 1. Monte Carlo valuation of European call option</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python"><span class="comment">#</span>
<span class="comment"># Monte Carlo valuation of European call option</span>
<span class="comment"># in Black-Scholes-Merton model</span>
<span class="comment"># bsm_mcs_euro.py</span>
<span class="comment">#</span>
<span class="comment"># Python for Finance, 2nd ed.</span>
<span class="comment"># (c) Dr. Yves J. Hilpisch</span>
<span class="comment">#</span>
<span class="keyword">import</span> <span class="include">math</span>
<span class="keyword">import</span> <span class="include">numpy</span> <span class="keyword">as</span> np

<span class="comment"># Parameter Values</span>
S0 = <span class="float">100.</span>  <span class="comment"># initial index level</span>
K = <span class="float">105.</span>  <span class="comment"># strike price</span>
T = <span class="float">1.0</span>  <span class="comment"># time-to-maturity</span>
r = <span class="float">0.05</span>  <span class="comment"># riskless short rate</span>
sigma = <span class="float">0.2</span>  <span class="comment"># volatility</span>

I = <span class="integer">100000</span>  <span class="comment"># number of simulations</span>

<span class="comment"># Valuation Algorithm</span>
z = np.random.standard_normal(I)  <span class="comment"># pseudo-random numbers</span>
<span class="comment"># index values at maturity</span>
ST = S0 * np.exp((r - <span class="float">0.5</span> * sigma ** <span class="integer">2</span>) * T + sigma * math.sqrt(T) * z)
hT = np.maximum(ST - K, <span class="integer">0</span>)  <span class="comment"># payoff at maturity</span>
C0 = math.exp(-r * T) * np.mean(hT)  <span class="comment"># Monte Carlo estimator</span>

<span class="comment"># Result Output</span>
print(<span class="string"><span class="delimiter">'</span><span class="content">Value of the European call option %5.3f.</span><span class="delimiter">'</span></span> % C0)</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>The algorithmic example in this subsection illustrates that Python, with its very syntax, is well suited to complement the classic duo of scientific languages, English and mathematics. It seems that adding <code>Python</code> to the set of scientific languages makes it more well rounded. One then has:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>English</strong> for <em>writing, talking</em> about scientific and financial problems, etc.</p>
</li>
<li>
<p><strong>Mathematics</strong> for <em>concisely, exactly describing and modeling</em> abstract aspects, algorithms, complex quantities, etc.</p>
</li>
<li>
<p><strong>Python</strong> for <em>technically modeling and implementing</em> abstract aspects, algorithms, complex quantities, etc.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Mathematics and Python Syntax</div>
<div class="paragraph">
<p>There is hardly any programming language that comes as close to mathematical syntax as Python. Numerical algorithms are therefore in general straightforward to translate from the mathematical representation into the <code>Pythonic</code> implementation. This makes prototyping, development and code maintenance in finance quite efficient with Python.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In some areas, it is common practice to use <em>pseudo-code</em> and therewith to introduce a fourth language family member. The role of pseudo-code is to represent, for example, financial algorithms in a more technical fashion that is both still close to the mathematical representation and already quite close to the technical implementation. In addition to the algorithm itself, pseudo-code takes into account how computers work in principle.</p>
</div>
<div class="paragraph">
<p>This practice generally has its cause in the fact that with most (compiled) programming languages the technical implementation is quite &#8220;far away&#8221; from its formal, mathematical representation. The majority of programming languages make it necessary to include so many elements that are only technically required that it is hard to see the equivalence between the mathematics and the code.</p>
</div>
<div class="paragraph">
<p>Nowadays, Python is often used in a <em>pseudo-code way</em> since its syntax is almost analogous to the mathematics and since the technical &#8220;overhead&#8221; is kept to a minimum. This is accomplished by a number of high-level concepts embodied in the language that not only have their advantages but also come in general with risks and/or other costs. However, it is safe to say that with Python you can, whenever the need arises, follow the same strict implementation and coding practices that other languages might require from the outset. In that sense, Python can provide the best of both worlds: <em>high-level abstraction</em> and <em>rigorous implementation</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_efficiency_and_productivity_through_python">1.2. Efficiency and Productivity Through Python</h3>
<div class="paragraph">
<p>At a high level, benefits from using Python can be measured in three dimensions:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">efficiency</dt>
<dd>
<p>how can Python help in getting results faster, in saving costs, and in saving time?</p>
</dd>
<dt class="hdlist1">productivity</dt>
<dd>
<p>how can Python help in getting more done with the same resources (people, assets, etc.)?</p>
</dd>
<dt class="hdlist1">quality</dt>
<dd>
<p>what does Python allow to do that alternative technologies do not allow for?</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A discussion of these aspects can by nature not be exhaustive. However, it can highlight some arguments as a starting point.</p>
</div>
<div class="sect3">
<h4 id="_shorter_time_to_results">1.2.1. Shorter Time-to-Results</h4>
<div class="paragraph">
<p>A field where the efficiency of Python becomes quite obvious is interactive data analytics. This is a field that benefits tremendously from such powerful tools as <code>IPython</code>, <code>Jupyter Notebook</code> and packages like <code>pandas</code>.</p>
</div>
<div class="paragraph">
<p>Consider a finance student, writing her master&#8217;s thesis and interested in S&amp;P 500 index values. She wants to analyze historical index levels for, say, a few years to see how the volatility of the index has fluctuated over time. She wants to find evidence that volatility, in contrast to some typical model assumptions, fluctuates over time and is far from being constant. The results should also be visualized. She mainly has to do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>retrieve index level data from the web</p>
</li>
<li>
<p>calculate the annualized rolling standard deviation of the log returns (volatility)</p>
</li>
<li>
<p>plot the index level data and the volatility results</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These tasks are complex enough that not too long ago one would have considered them to be something for professional financial analysts only. Today, even the finance student can easily cope with such problems. The code below shows how exactly this works&#8201;&#8212;&#8201;without worrying about syntax details at this stage (everything is explained in detail in subsequent chapters).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">In [<span class="integer">11</span>]: <span class="keyword">import</span> <span class="include">numpy</span> <span class="keyword">as</span> np  <i class="conum" data-value="1"></i><b>(1)</b>
         <span class="keyword">import</span> <span class="include">pandas</span> <span class="keyword">as</span> pd  <i class="conum" data-value="1"></i><b>(1)</b>
         <span class="keyword">from</span> <span class="include">pylab</span> <span class="keyword">import</span> <span class="include">plt</span>, <span class="include">mpl</span>  <i class="conum" data-value="2"></i><b>(2)</b>

In [<span class="integer">12</span>]: plt.style.use(<span class="string"><span class="delimiter">'</span><span class="content">seaborn</span><span class="delimiter">'</span></span>)  <i class="conum" data-value="2"></i><b>(2)</b>
         mpl.rcParams[<span class="string"><span class="delimiter">'</span><span class="content">font.family</span><span class="delimiter">'</span></span>] = <span class="string"><span class="delimiter">'</span><span class="content">serif</span><span class="delimiter">'</span></span>  <i class="conum" data-value="2"></i><b>(2)</b>
         %matplotlib inline

In [<span class="integer">13</span>]: data = pd.read_csv(<span class="string"><span class="delimiter">'</span><span class="content">http://hilpisch.com/tr_eikon_eod_data.csv</span><span class="delimiter">'</span></span>,
                           index_col=<span class="integer">0</span>, parse_dates=<span class="predefined-constant">True</span>)  <i class="conum" data-value="3"></i><b>(3)</b>
         data = pd.DataFrame(data[<span class="string"><span class="delimiter">'</span><span class="content">.SPX</span><span class="delimiter">'</span></span>]) <i class="conum" data-value="4"></i><b>(4)</b>
         data.dropna(inplace=<span class="predefined-constant">True</span>)  <i class="conum" data-value="4"></i><b>(4)</b>
         data.info()  <i class="conum" data-value="5"></i><b>(5)</b>
         &lt;<span class="keyword">class</span> <span class="string"><span class="delimiter">'</span><span class="content">pandas.core.frame.DataFrame</span><span class="delimiter">'</span></span>&gt;
         DatetimeIndex: <span class="integer">2138</span> entries, <span class="integer">2010</span>-<span class="octal">01</span>-<span class="octal">04</span> to <span class="integer">2018</span>-<span class="octal">06</span>-<span class="integer">29</span>
         Data columns (total <span class="integer">1</span> columns):
         .SPX    <span class="integer">2138</span> non-null float64
         dtypes: float64(<span class="integer">1</span>)
         memory usage: <span class="float">33.4</span> KB

In [<span class="integer">14</span>]: data[<span class="string"><span class="delimiter">'</span><span class="content">rets</span><span class="delimiter">'</span></span>] = np.log(data / data.shift(<span class="integer">1</span>))  <i class="conum" data-value="6"></i><b>(6)</b>
         data[<span class="string"><span class="delimiter">'</span><span class="content">vola</span><span class="delimiter">'</span></span>] = data[<span class="string"><span class="delimiter">'</span><span class="content">rets</span><span class="delimiter">'</span></span>].rolling(<span class="integer">252</span>).std() * np.sqrt(<span class="integer">252</span>)  <i class="conum" data-value="7"></i><b>(7)</b>

In [<span class="integer">15</span>]: data[[<span class="string"><span class="delimiter">'</span><span class="content">.SPX</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">vola</span><span class="delimiter">'</span></span>]].plot(subplots=<span class="predefined-constant">True</span>, figsize=(<span class="integer">10</span>, <span class="integer">6</span>));  <i class="conum" data-value="8"></i><b>(8)</b>
         plt.savefig(<span class="string"><span class="delimiter">'</span><span class="content">../images/spx_volatility.png</span><span class="delimiter">'</span></span>)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This imports <code>NumPy</code> and <code>pandas</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This imports <code>matplotlib</code> and configures the plotting style and approach for <code>Jupyter</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>pd.read_csv()</code> allows the retrieval of remotely or locally stored data sets in <code>CSV</code> form.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>A sub-set of the data is picked and <code>NaN</code> ("not a number") values eliminated.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>This shows some meta-information about the data set.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>The log returns are calculated in vectorized fashion (&#8220;no looping&#8221; on the Python level).</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>The rolling, annualized volatility is derived.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>This finally plots the two time series.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="#spx_vola">S&amp;P 500 closing values and annualized volatility</a> shows the graphical result of this brief interactive session. It can be considered almost amazing that a few lines of code suffice to implement three rather complex tasks typically encountered in financial analytics: data gathering, complex and repeated mathematical calculations as well as visualization of the results. The example illustrates that <code>pandas</code> makes working with whole time series almost as simple as doing mathematical operations on floating-point numbers.</p>
</div>
<div id="spx_vola" class="imageblock">
<div class="content">
<img src="images/spx_volatility.png" alt="spx volatility">
</div>
<div class="title">Figure 1. S&amp;P 500 closing values and annualized volatility</div>
</div>
<div class="paragraph">
<p>Translated to a professional finance context, the example implies that financial analysts can&#8201;&#8212;&#8201;when applying the right Python tools and packages that provide high-level abstractions&#8201;&#8212;&#8201;focus on their very domain and not on the technical intrinsicalities. Analysts can react faster, providing valuable insights almost in real-time and making sure they are one step ahead of the competition. This example of <em>increased efficiency</em> can easily translate into measurable bottom-line effects.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ensuring_high_performance">1.2.2. Ensuring High Performance</h4>
<div class="paragraph">
<p>In general, it is accepted that Python has a rather concise syntax and that it is relatively efficient to code with. However, due to the very nature of Python being an interpreted language, the <em>prejudice</em> persists that Python often is too slow for compute-intensive tasks in finance. Indeed, depending on the specific implementation approach, Python can be really slow. But it <em>does not have to be slow</em>&#8201;&#8212;&#8201;it can be highly performing in almost any application area. In principle, one can distinguish at least three different strategies for better performance:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">idioms and paradigms</dt>
<dd>
<p>in general, many different ways can lead to the same result in Python, but sometimes with rather different performance characteristics; &#8220;simply&#8221; choosing the right way (e.g., a specific implementation approach, such as the judicious use of data structures, avoiding loops through vectorization or the use of a specific package such as <code>pandas</code>) can improve results significantly</p>
</dd>
<dt class="hdlist1">compiling</dt>
<dd>
<p>nowadays, there are several performance packages available that provide compiled versions of important functions or that compile Python code statically or dynamically (at runtime or call time) to machine code, which can make such functions orders of magnitude faster than pure Python code; popular ones are <code>Cython</code> and <code>Numba</code></p>
</dd>
<dt class="hdlist1">parallelization</dt>
<dd>
<p>many computational tasks, in particular in finance, can significantly benefit from parallel execution; this is nothing special to Python but something that can easily be accomplished with it</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="title">Performance Computing with Python</div>
<div class="paragraph">
<p>Python per se is not a high-performance computing technology. However, Python has developed into an ideal platform to access current performance technologies. In that sense, Python has become something like a <em>glue language</em> for performance computing technologies.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Later chapters illustrate all three strategies in detail. This sub-section sticks to a simple, but still realistic, example that touches upon all three strategies. A quite common task in financial analytics is to evaluate complex mathematical expressions on large arrays of numbers. To this end, Python itself provides everything needed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">In [<span class="integer">16</span>]: <span class="keyword">import</span> <span class="include">math</span>
         loops = <span class="integer">2500000</span>
         a = <span class="predefined">range</span>(<span class="integer">1</span>, loops)
         <span class="keyword">def</span> <span class="function">f</span>(x):
             <span class="keyword">return</span> <span class="integer">3</span> * math.log(x) + math.cos(x) ** <span class="integer">2</span>
         %timeit r = [f(x) <span class="keyword">for</span> x <span class="keyword">in</span> a]
         <span class="float">1.21</span> s <span class="error">±</span> <span class="float">8.27</span> ms per loop (mean <span class="error">±</span> std. dev. of <span class="integer">7</span> runs, <span class="integer">1</span> loop each)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Python interpreter needs about 1.4 seconds in this case to evaluate the function <code>f</code> 2,500,000 times. The same task can be implemented using <code>NumPy</code>, which provides optimized (i.e., <em>pre-compiled</em>), functions to handle such array-based operations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">In [<span class="integer">17</span>]: <span class="keyword">import</span> <span class="include">numpy</span> <span class="keyword">as</span> np
         a = np.arange(<span class="integer">1</span>, loops)
         %timeit r = <span class="integer">3</span> * np.log(a) + np.cos(a) ** <span class="integer">2</span>
         <span class="float">94.7</span> ms <span class="error">±</span> <span class="float">1.55</span> ms per loop (mean <span class="error">±</span> std. dev. of <span class="integer">7</span> runs, <span class="integer">10</span> loops each)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>NumPy</code> considerably reduces the execution time to about 80 milliseconds. However, there is even a package specifically dedicated to this kind of task. It is called <code>numexpr</code>, for "`numerical expressions." It <em>compiles</em> the expression to improve upon the performance of the general <code>NumPy</code> functionality by, for example, avoiding in-memory copies of <code>ndarray</code> objects along the way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">In [<span class="integer">18</span>]: <span class="keyword">import</span> <span class="include">numexpr</span> <span class="keyword">as</span> ne
         ne.set_num_threads(<span class="integer">1</span>)
         f = <span class="string"><span class="delimiter">'</span><span class="content">3 * log(a) + cos(a) ** 2</span><span class="delimiter">'</span></span>
         %timeit r = ne.evaluate(f)
         <span class="float">37.5</span> ms <span class="error">±</span> <span class="integer">936</span> µs per loop (mean <span class="error">±</span> std. dev. of <span class="integer">7</span> runs, <span class="integer">10</span> loops each)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Using this more specialized approach further reduces execution time to about 40 milliseconds. However, <code>numexpr</code> also has built-in capabilities to parallelize the execution of the respective operation. This allows us to use multiple threads of a CPU.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="python">In [<span class="integer">19</span>]: ne.set_num_threads(<span class="integer">4</span>)
         %timeit r = ne.evaluate(f)
         <span class="float">12.8</span> ms <span class="error">±</span> <span class="integer">300</span> µs per loop (mean <span class="error">±</span> std. dev. of <span class="integer">7</span> runs, <span class="integer">100</span> loops each)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Parallelization brings execution time further down to below 15 milliseconds in this case, with four threads utilized. Overall, this is a performance improvement of more than 90 times. Note, in particular, that this kind of improvement is possible without altering the basic problem/algorithm and without knowing any detail about compiling or parallelization approaches. The capabilities are accessible from a high level even by non-experts. However, one has to be aware, of course, of which capabilities and options exist.</p>
</div>
<div class="paragraph">
<p>The example shows that Python provides a number of options to make more out of existing resources&#8201;&#8212;&#8201;i.e., to <em>increase productivity</em>. With the parallel approach, three times as many calculations can be accomplished in the same amount of time as compared to the sequential approach&#8201;&#8212;&#8201;in this case simply by telling Python to use multiple available CPU threads instead of just one.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusions">1.3. Conclusions</h3>
<div class="paragraph">
<p>Python as a language&#8201;&#8212;&#8201;and even more so as an ecosystem&#8201;&#8212;&#8201;is an ideal technological framework for the financial industry as whole and the individual working in finance alike. It is characterized by a number of benefits, like an elegant syntax, efficient development approaches and usability for prototyping <em>as well as</em> production. With its huge amount of available packages, libraries and tools, Python seems to have answers to most questions raised by recent developments in the financial industry in terms of analytics, data volumes and frequency, compliance and regulation, as well as technology itself. It has the potential to provide a <em>single, powerful, consistent framework</em> with which to streamline end-to-end development and production efforts even across larger financial institutions.</p>
</div>
<div class="paragraph">
<p>In addition, Python has become the programming language of choice for <em>artificial intelligence</em> in general and <em>machine and deep learning</em> in particular. Python is therefore both the right language for <em>data-driven finance</em> as well as for <em>AI-first finance</em>, two recent trends that are about to reshape finance and the financial industry in fundamental ways.</p>
</div>
</div>
<div class="sect2">
<h3 id="_further_resources">1.4. Further Resources</h3>
<div class="paragraph">
<p>The following books cover several aspects only touched upon in this chapter in more detail (e.g. Python tools, derivatives analytics, machine learning in general, machine learning in finance):</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hilpisch, Yves (2015): <em>Derivatives Analytics with Python</em>. Wiley Finance, Chichester, England. <a href="http://dawp.tpq.io" class="bare">http://dawp.tpq.io</a>.</p>
</li>
<li>
<p>López de Prado, Marcos (2018): <em>Advances in Financial Machine Learning</em>. John Wiley &amp; Sons, Hoboken.</p>
</li>
<li>
<p>VanderPlas, Jake (2016): <em>Python Data Science Handbook</em>. O&#8217;Reilly, Beijing et al.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When it comes to algorithmic trading, the author&#8217;s company offers a range of online training programs that focus on Python and other tools and techniques required in this rapidly growing field:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://pyalgo.tpq.io" class="bare">http://pyalgo.tpq.io</a>&#8201;&#8212;&#8201;online training course</p>
</li>
<li>
<p><a href="http://certificate.tpq.io" class="bare">http://certificate.tpq.io</a>&#8201;&#8212;&#8201;online training program</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Sources referenced in this chapter are, among others, the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ding, Cubillas (2010): &#8220;Optimizing the OTC Pricing and Valuation Infrastructure.&#8221; <em>Celent study</em>.</p>
</li>
<li>
<p>Lewis, Michael (2014): <em>Flash Boys</em>. W. W. Norton &amp; Company, New York.</p>
</li>
<li>
<p>Patterson, Scott (2010): <em>The Quants.</em> Crown Business, New York.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-12-27 13:57:57 CET
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>